'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _utils=require('../utils');function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step('next',value)},function(err){step('throw',err)})}}return step('next')})}}class RedirectBehaviour{constructor({host,port}){this._host='';this._port='';if(!(0,_utils.isValidHostname)(host)){throw Error('\'host\' is invalid')}if(!(0,_utils.isValidPort)(port)){throw Error('\'port\' is invalid')}this._host=host;this._port=port}run({action,remoteHost,remotePort,connect,setPresets}){var _this=this;return _asyncToGenerator(function*(){const orgData=action.payload.orgData;var _ref=[_this._host,_this._port];const host=_ref[0],port=_ref[1];_utils.logger.warn(`[behaviour] [${remoteHost}:${remotePort}] connection is redirecting to ${host}:${port}`);setPresets(function(){return[{name:'tracker'}]});const fsocket=yield connect({host,port});if(fsocket&&fsocket.writable){fsocket.write(orgData)}})()}}exports.default=RedirectBehaviour;
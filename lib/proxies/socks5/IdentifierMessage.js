'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.IdentifierMessage=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _common=require('../common');class IdentifierMessage extends _common.Message{constructor(options){super();const fields=_extends({VER:_common.SOCKS_VERSION_V5,NMETHODS:1,METHODS:[_common.METHOD_NO_AUTH]},options);this.VER=fields.VER;this.NMETHODS=fields.NMETHODS;this.METHODS=fields.METHODS}static parse(buffer){if(buffer.length<3){return null}if(buffer[0]!==_common.SOCKS_VERSION_V5){return null}if(buffer[1]<1){return null}if(buffer.slice(2).length!==buffer[1]){return null}return new IdentifierMessage({VER:buffer[0],NMETHODS:buffer[1],METHODS:buffer.slice(2)})}toBuffer(){return Buffer.from([this.VER,this.NMETHODS,...this.METHODS])}}exports.IdentifierMessage=IdentifierMessage;
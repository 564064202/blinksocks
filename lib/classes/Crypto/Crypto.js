'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.Crypto=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _crypto=require('crypto');var _crypto2=_interopRequireDefault(_crypto);var _Config=require('../Config');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var HASH_SALT='blinksocks';/**
 * encrypt/decrypt data by a cipher/key obtained from config.json
 */var Crypto=exports.Crypto=function(){function Crypto(){_classCallCheck(this,Crypto)}_createClass(Crypto,null,[{key:'encrypt',value:function encrypt(plainText){var _ref=[_Config.Config.cipher,_Config.Config.key],cipherName=_ref[0],key=_ref[1];if(cipherName===''){return plainText}else{var cipher=_crypto2.default.createCipher(cipherName,key);return Buffer.concat([cipher.update(plainText),cipher.final()])}}},{key:'decrypt',value:function decrypt(cipherText){var _ref2=[_Config.Config.cipher,_Config.Config.key],cipherName=_ref2[0],key=_ref2[1];if(cipherName===''){return cipherText}else{var decipher=_crypto2.default.createDecipher(cipherName,key);return Buffer.concat([decipher.update(cipherText),decipher.final()])}}},{key:'hash',value:function hash(text){var hash=_crypto2.default.createHash('sha256');hash.update(Buffer.concat([Buffer.from(text),Buffer.from(HASH_SALT)]));return hash.digest('hex')}}]);return Crypto}();
'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.Crypto=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _crypto=require('crypto');var _crypto2=_interopRequireDefault(_crypto);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var CRYPTO_HASH_SALT='blinksocks';var cipherKeyIVLens={'aes-128-ctr':[16,16],'aes-192-ctr':[24,16],'aes-256-ctr':[32,16],'aes-128-cfb':[16,16],'aes-192-cfb':[24,16],'aes-256-cfb':[32,16],'aes-128-ofb':[16,16],'aes-192-ofb':[24,16],'aes-256-ofb':[32,16],'aes-128-cbc':[16,16],'aes-192-cbc':[24,16],'aes-256-cbc':[32,16]};var hmacLens={'sha1':20,'sha256':32,'sha512':64};var Crypto=exports.Crypto=function(){function Crypto(){_classCallCheck(this,Crypto)}_createClass(Crypto,null,[{key:'createCipher',value:function createCipher(cipher,key,iv){if(iv instanceof Buffer){return _crypto2.default.createCipheriv(cipher,key,iv)}else{return _crypto2.default.createCipher(cipher,key)}}},{key:'createDecipher',value:function createDecipher(cipher,key,iv){if(iv instanceof Buffer){return _crypto2.default.createDecipheriv(cipher,key,iv)}else{return _crypto2.default.createDecipher(cipher,key)}}},{key:'createHmac',value:function createHmac(hash,key){return _crypto2.default.createHmac(hash,key)}},{key:'randomBytes',value:function randomBytes(len){return _crypto2.default.randomBytes(len)}},{key:'getIVLength',value:function getIVLength(cipher){return cipherKeyIVLens[cipher][1]}},{key:'getHmacLength',value:function getHmacLength(algorithm){return hmacLens[algorithm]}},{key:'getStrongKey',value:function getStrongKey(cipher,key){var hash=_crypto2.default.createHash('sha256');var keyLen=cipherKeyIVLens[cipher][0];hash.update(Buffer.concat([Buffer.from(key),Buffer.from(CRYPTO_HASH_SALT)]));return hash.digest().slice(0,keyLen)}},{key:'isCipherAvailable',value:function isCipherAvailable(cipher){return!(typeof cipherKeyIVLens[cipher]==='undefined')}},{key:'isHashAvailable',value:function isHashAvailable(hash){return!(typeof hmacLens[hash]==='undefined')}},{key:'generateIV',value:function generateIV(cipher){return _crypto2.default.randomBytes(this.getIVLength(cipher))}},{key:'getAvailableCiphers',value:function getAvailableCiphers(){return Object.keys(cipherKeyIVLens)}},{key:'getAvailableHashes',value:function getAvailableHashes(){return Object.keys(hmacLens)}}]);return Crypto}();
'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.Utils=exports.BYTE_ORDER_LE=exports.BYTE_ORDER_BE=undefined;var _net=require('net');var _net2=_interopRequireDefault(_net);var _url=require('url');var _url2=_interopRequireDefault(_url);var _crypto=require('crypto');var _crypto2=_interopRequireDefault(_crypto);var _common=require('../proxies/common');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}const BYTE_ORDER_BE=exports.BYTE_ORDER_BE=0;const BYTE_ORDER_LE=exports.BYTE_ORDER_LE=1;class Utils{static numberToUInt(num,len=2,byteOrder=BYTE_ORDER_BE){if(len<1){throw Error('len must be greater than 0')}const isOutOfRange=num>parseInt(`0x${'ff'.repeat(len)}`);if(isOutOfRange){throw Error(`Number ${num} is too long to store in a '${len}' length buffer`)}const buf=Buffer.alloc(len);if(byteOrder===BYTE_ORDER_BE){buf.writeUIntBE(num,0,len)}else{buf.writeUIntLE(num,0,len)}return buf}static parseURI(uri){let _uri=uri;if(_uri.indexOf('http')!==0&&_uri.indexOf('https')!==0){if(_uri.indexOf(':443')!==-1){_uri=`https://${_uri}`}else{_uri=`http://${_uri}`}}var _url$parse=_url2.default.parse(_uri);const protocol=_url$parse.protocol,hostname=_url$parse.hostname;const isIp=_net2.default.isIP(hostname);const addrType=isIp?_net2.default.isIPv4(hostname)?_common.ATYP_V4:_common.ATYP_V6:_common.ATYP_DOMAIN;const port={'http:':80,'https:':443}[protocol];return{type:addrType,host:hostname,port}}static getRandomInt(min,max){min=Math.ceil(min);max=Math.floor(max);return Math.floor(Math.random()*(max-min))+min}static isValidPort(port){if(typeof port!=='number'){return false}if(port<0||port>65535){return false}return true}static md5(buffer){const md5=_crypto2.default.createHash('md5');md5.update(buffer);return md5.digest()}static EVP_BytesToKey(password,keyLen,ivLen){let _data=Buffer.from(password);let i=0;const bufs=[];while(Buffer.concat(bufs).length<keyLen+ivLen){if(i>0){_data=Buffer.concat([bufs[i-1],Buffer.from(password)])}bufs.push(this.md5(_data));i+=1}return Buffer.concat(bufs).slice(0,keyLen)}}exports.Utils=Utils;
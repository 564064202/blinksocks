'use strict';var _Crypto=require('../Crypto');jest.mock('../Config');var plainText=Buffer.from([0,1,2]);var cipherText=Buffer.from([155,128,80]);var hash='81226733f35ff94c86f0d4e7086184d016be2ed9435a583cdf178214228cd799';describe('Crypto#_create',function(){beforeEach(function(){var _require=require('../Config'),Config=_require.Config;Config.cipher='aes-256-cfb';Config.key='keyfortest'});it('should throw if type is invalid',function(){expect(function(){return _Crypto.Crypto._create('invalid_type',function(){return 0})}).toThrow()})});describe('Crypto#createCipher',function(){beforeEach(function(){var _require2=require('../Config'),Config=_require2.Config;Config.cipher='aes-256-cfb';Config.key='keyfortest'});it('should get cipherText',function(){var collector=jest.fn();var stream=_Crypto.Crypto.createCipher(collector);stream.write(plainText);expect(collector).toBeCalledWith(cipherText)})});describe('Crypto#createDecipher',function(){beforeEach(function(){var _require3=require('../Config'),Config=_require3.Config;Config.cipher='aes-256-cfb';Config.key='keyfortest';Config.isServer=true});it('should get plainText',function(){var collector=jest.fn();var stream=_Crypto.Crypto.createDecipher(collector);stream.write(cipherText);expect(collector).toBeCalledWith(plainText.slice(0,1))})});describe('Crypto without a cipher',function(){beforeEach(function(){var _require4=require('../Config'),Config=_require4.Config;Config.cipher='';Config.key=''});it('should get cipherText',function(){var collector=jest.fn();var stream=_Crypto.Crypto.createCipher(collector);stream.write(cipherText);expect(collector).toBeCalledWith(cipherText)});it('should get plainText',function(){var collector=jest.fn();var stream=_Crypto.Crypto.createDecipher(collector);stream.write(plainText);expect(collector).toBeCalledWith(plainText)})});describe('Crypto#hash',function(){it('should return right hash',function(){expect(_Crypto.Crypto.hash('abc')).toBe(hash)})});describe('Crypto#generateIV',function(){it('should return a CRYPTO_IV_LEN length buffer',function(){expect(_Crypto.Crypto.generateIV().length).toBe(_Crypto.CRYPTO_IV_LEN)})});describe('Crypto#isAvailable',function(){it('should return false if cipher is not available',function(){expect(_Crypto.Crypto.isAvailable('cipher')).toBe(false)})});describe('Crypto#getCiphers',function(){it('should return an array',function(){expect(Array.isArray(_Crypto.Crypto.getCiphers())).toBe(true)})});describe('Crypto#getKeySize',function(){it('should return 16',function(){expect(_Crypto.Crypto.getKeySize('aes-128-ctr')).toBe(16)})});